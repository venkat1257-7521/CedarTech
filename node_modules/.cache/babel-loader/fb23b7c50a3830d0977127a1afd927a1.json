{"ast":null,"code":"\"use strict\";\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  }\n  result[\"default\"] = mod;\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar prop_types_1 = require(\"prop-types\");\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar uiFunctions_1 = require(\"./uiFunctions\");\n\nvar ScrollRenderer = function ScrollRenderer(props) {\n  var list = props.list,\n      renderItem = props.renderItem,\n      groupSeparator = props.groupSeparator;\n\n  var _a = react_1.useState({\n    renderList: [],\n    index: 0\n  }),\n      render = _a[0],\n      setRender = _a[1];\n\n  var _b = react_1.useState(false),\n      mounted = _b[0],\n      setMounted = _b[1];\n\n  var _c = react_1.useState(-1),\n      setupCount = _c[0],\n      setSetupCount = _c[1];\n\n  var containerRef = react_1.createRef();\n  var renderThisItem = uiFunctions_1.handleRenderItem(renderItem, uiFunctions_1.handleRenderGroupSeparator(groupSeparator));\n\n  var updateRenderInfo = function updateRenderInfo(count) {\n    if (count === void 0) {\n      count = 10;\n    }\n\n    if (render.index < list.length) {\n      var index = render.index + count;\n      setRender({\n        renderList: list.slice(0, index),\n        index: index\n      });\n    }\n  };\n\n  var onScroll = function onScroll(span) {\n    return function () {\n      requestAnimationFrame(function () {\n        if (span) {\n          var startingPoint = span.parentNode.offsetTop + span.parentNode.offsetHeight;\n          var anchorPos = span.offsetTop - span.parentNode.scrollTop;\n\n          if (anchorPos <= startingPoint + span.parentNode.offsetHeight * 2) {\n            updateRenderInfo();\n          }\n        }\n      });\n    };\n  };\n\n  react_1.useEffect(function () {\n    setMounted(true);\n    return function () {\n      setMounted(false);\n    };\n  }, []);\n  react_1.useLayoutEffect(function () {\n    if (mounted) {\n      // reset list on list change\n      var span_1 = containerRef.current;\n      var pos_1 = span_1.parentNode.scrollTop;\n      var index = Math.max(render.renderList.length, setupCount);\n      setRender({\n        renderList: list.slice(0, index),\n        index: index\n      });\n      requestAnimationFrame(function () {\n        if (span_1 && span_1.parentNode) {\n          span_1.parentNode.scrollTop = pos_1;\n        }\n      });\n    }\n  }, [list]);\n  react_1.useLayoutEffect(function () {\n    var span = containerRef.current;\n    var handleScroll = onScroll(span);\n    var container = null;\n\n    if (span) {\n      container = span.parentNode;\n      requestAnimationFrame(function () {\n        // populate double the container height of items\n        if (render.index === 0 || container.scrollHeight <= container.offsetHeight * 2) {\n          updateRenderInfo();\n        } else if (setupCount === -1) {\n          setSetupCount(render.index);\n        }\n      });\n      container.addEventListener('scroll', handleScroll, {\n        passive: true\n      });\n    }\n\n    return function () {\n      if (span) {\n        container.removeEventListener('scroll', handleScroll, {\n          passive: true\n        });\n      }\n    };\n  }, [render.index, list.length]);\n  return react_1.default.createElement(react_1.default.Fragment, null, render.renderList.map(renderThisItem), react_1.default.createElement(\"span\", {\n    ref: containerRef,\n    style: {\n      visibility: 'hidden',\n      height: 1\n    },\n    className: \"___scroll-renderer-anchor\"\n  }));\n};\n\nScrollRenderer.propTypes = {\n  list: prop_types_1.arrayOf(prop_types_1.any).isRequired,\n  renderItem: prop_types_1.func.isRequired,\n  groupSeparator: prop_types_1.oneOfType([prop_types_1.node, prop_types_1.func, prop_types_1.element])\n};\nScrollRenderer.defaultProps = {\n  groupSeparator: null\n};\nexports.default = ScrollRenderer;","map":{"version":3,"sources":["../../src/___subComponents/ScrollRenderer.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar prop_types_1 = require(\"prop-types\");\nvar react_1 = __importStar(require(\"react\"));\nvar uiFunctions_1 = require(\"./uiFunctions\");\nvar ScrollRenderer = function (props) {\n    var list = props.list, renderItem = props.renderItem, groupSeparator = props.groupSeparator;\n    var _a = react_1.useState({ renderList: [], index: 0 }), render = _a[0], setRender = _a[1];\n    var _b = react_1.useState(false), mounted = _b[0], setMounted = _b[1];\n    var _c = react_1.useState(-1), setupCount = _c[0], setSetupCount = _c[1];\n    var containerRef = react_1.createRef();\n    var renderThisItem = uiFunctions_1.handleRenderItem(renderItem, uiFunctions_1.handleRenderGroupSeparator(groupSeparator));\n    var updateRenderInfo = function (count) {\n        if (count === void 0) { count = 10; }\n        if (render.index < list.length) {\n            var index = render.index + count;\n            setRender({\n                renderList: list.slice(0, index),\n                index: index\n            });\n        }\n    };\n    var onScroll = function (span) { return function () {\n        requestAnimationFrame(function () {\n            if (span) {\n                var startingPoint = span.parentNode.offsetTop + span.parentNode.offsetHeight;\n                var anchorPos = span.offsetTop - span.parentNode.scrollTop;\n                if (anchorPos <= (startingPoint + (span.parentNode.offsetHeight * 2))) {\n                    updateRenderInfo();\n                }\n            }\n        });\n    }; };\n    react_1.useEffect(function () {\n        setMounted(true);\n        return function () {\n            setMounted(false);\n        };\n    }, []);\n    react_1.useLayoutEffect(function () {\n        if (mounted) { // reset list on list change\n            var span_1 = containerRef.current;\n            var pos_1 = span_1.parentNode.scrollTop;\n            var index = Math.max(render.renderList.length, setupCount);\n            setRender({\n                renderList: list.slice(0, index),\n                index: index\n            });\n            requestAnimationFrame(function () {\n                if (span_1 && span_1.parentNode) {\n                    span_1.parentNode.scrollTop = pos_1;\n                }\n            });\n        }\n    }, [list]);\n    react_1.useLayoutEffect(function () {\n        var span = containerRef.current;\n        var handleScroll = onScroll(span);\n        var container = null;\n        if (span) {\n            container = span.parentNode;\n            requestAnimationFrame(function () {\n                // populate double the container height of items\n                if (render.index === 0 || (container.scrollHeight <= (container.offsetHeight * 2))) {\n                    updateRenderInfo();\n                }\n                else if (setupCount === -1) {\n                    setSetupCount(render.index);\n                }\n            });\n            container.addEventListener('scroll', handleScroll, { passive: true });\n        }\n        return function () {\n            if (span) {\n                container.removeEventListener('scroll', handleScroll, { passive: true });\n            }\n        };\n    }, [render.index, list.length]);\n    return (react_1.default.createElement(react_1.default.Fragment, null,\n        render.renderList.map(renderThisItem),\n        react_1.default.createElement(\"span\", { ref: containerRef, style: { visibility: 'hidden', height: 1 }, className: \"___scroll-renderer-anchor\" })));\n};\nScrollRenderer.propTypes = {\n    list: prop_types_1.arrayOf(prop_types_1.any).isRequired,\n    renderItem: prop_types_1.func.isRequired,\n    groupSeparator: prop_types_1.oneOfType([prop_types_1.node, prop_types_1.func, prop_types_1.element])\n};\nScrollRenderer.defaultProps = {\n    groupSeparator: null\n};\nexports.default = ScrollRenderer;\n//# sourceMappingURL=ScrollRenderer.js.map"]},"metadata":{},"sourceType":"script"}